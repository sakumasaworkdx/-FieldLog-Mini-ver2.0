<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <link rel="stylesheet" href="./styles.css?v=110" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <title>FieldLog Mini v4.0</title>
  <style>
    #map { width: 100%; height: 250px; margin-top: 5px; border-radius: 8px; border: 1px solid #444; background: #222; z-index: 1; }
    .map-notice { font-size: 10px; color: #ffcc00; margin-bottom: 5px; line-height: 1.2; font-weight: bold; }
    .map-controls { display: flex; gap: 5px; margin-bottom: 5px; }
    .btn-map { flex: 1; padding: 8px 5px; font-size: 11px; border-radius: 5px; cursor: pointer; border: none; background: #333; color: white; }
    .btn-map:active { background: #555; }
  </style>
</head>
<body>
  <main class="container">
    <details class="card settings-card">
      <summary>âš™ï¸ CSVèª­ã¿è¾¼ã¿ (åœ°ç‚¹,å°åŒºåˆ†,é …ç›®)</summary>
      <input id="listCsvInput" type="file" accept=".csv" style="margin-top:10px;" />
    </details>

    <section class="card">
      <div class="action-grid">
        <label class="btn-main photo-btn">
          <input id="photoInput" type="file" accept="image/*" capture="environment">
          <span class="icon">ğŸ“·</span>
          <span class="label">å†™çœŸ <span id="photoCheck"></span></span>
        </label>
        <button id="btnGeo" class="btn-main geo-btn" type="button">
          <span class="icon">ğŸ“</span>
          <span class="label">GPSãƒ»æ–¹ä½å–å¾— <span id="geoCheck"></span></span>
        </button>
      </div>

      <div id="previewContainer" style="text-align:center; display:none; margin-bottom:15px;">
        <img id="imgPreview" style="max-width:100%; height:auto; border-radius:8px; border:1px solid #444;">
        <div id="previewLabel" style="font-size:12px; color:#aaa; margin-top:5px;"></div>
      </div>

      <div class="geo-info">
        ç·¯åº¦: <span id="lat">-</span> / çµŒåº¦: <span id="lng">-</span><br>
        æ–¹ä½: <span id="heading">-</span>
      </div>

      <select id="selLocation" class="input-field"><option value="">åœ°ç‚¹ã‚’é¸æŠ</option></select>
      <select id="selSubLocation" class="input-field"><option value="">å°åŒºåˆ†ã‚’é¸æŠ</option></select>
      <select id="selItem" class="input-field"><option value="">é …ç›®ã‚’é¸æŠ</option></select>
      <textarea id="memo" class="input-field memo-area" placeholder="å‚™è€ƒ"></textarea>
      <button id="btnSave" class="btn-save" type="button">ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜</button>
    </section>

    <section class="card history-card">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <h2 style="font-size:14px; margin:0;">ğŸ“Š å±¥æ­´ã¨åœ°å›³</h2>
        <div style="display:flex; gap:8px;">
            <button id="btnDownloadAll" class="btn-blue" style="padding:5px 10px; font-size:12px; border-radius:5px;">ğŸ“¦ ä¸€æ‹¬DL</button>
            <button id="btnDeleteAll" style="padding:5px 10px; font-size:12px; border-radius:5px; background:#660000; color:white; border:none;">âš ï¸ å…¨å‰Šé™¤</button>
        </div>
      </div>

      <div class="map-notice">âš ï¸ ç¾å ´ã§ã¯äº‹å‰ã«è¡¨ç¤ºãƒ»æ‹¡å¤§ã—ãŸç¯„å›²ã®ã¿è¡¨ç¤ºã•ã‚Œã¾ã™</div>
      <div class="map-controls">
        <button id="btnZoomFit" class="btn-map">ğŸ“ å…¨ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</button>
        <button id="btnJumpBase" class="btn-map">ğŸ  æœ¬æ‹ åœ°ã¸ç§»å‹•</button>
      </div>
      <div id="map"></div>

      <div class="table-container" style="margin-top:15px;">
        <table>
          <thead><tr><th>åœ°ç‚¹</th><th>å°åŒºåˆ†</th><th>é …ç›®</th><th>å†™</th><th>G</th></tr></thead>
          <tbody id="list"></tbody>
        </table>
      </div>
    </section>
  </main>
  <script src="../jszip.min.js"></script>
  <script src="./app.js?v=110"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('../sw.js').then(() => console.log("SW Active"));
    }
  </script>
</body>
</html>
