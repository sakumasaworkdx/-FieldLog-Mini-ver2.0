<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <link rel="stylesheet" href="./styles.css" />
  <title>FieldLog v3.7 (Stable)</title>
</head>
<body>
  <main class="container">
    <section class="card">
      <div class="action-grid">
        <label class="btn-main photo-btn">
          <input id="photoInput" type="file" accept="image/*" capture="environment">
          <span class="icon">📷</span><span class="label">写真 <span id="photoCheck"></span></span>
        </label>
        <button id="btnGeo" class="btn-main geo-btn" type="button">
          <span class="icon">📍</span><span class="label">GPS・方位取得 <span id="geoCheck"></span></span>
        </button>
      </div>
      <div id="previewContainer" style="text-align:center; display:none; margin-bottom:15px;">
        <img id="imgPreview" style="max-width:100%; height:auto; border-radius:8px;">
      </div>
      <div class="geo-info">
        緯度: <span id="lat">-</span> / 経度: <span id="lng">-</span><br>
        方位: <span id="heading">-</span>
      </div>
      <select id="selLocation" class="input-field"><option value="">地点を選択</option></select>
      <select id="selSubLocation" class="input-field"><option value="">小区分を選択</option></select>
      <select id="selItem" class="input-field"><option value="">項目を選択</option></select>
      <textarea id="memo" class="input-field memo-area" placeholder="備考"></textarea>
      <button id="btnSave" class="btn-save" type="button">💾 データを保存</button>
    </section>

    <section class="card history-card">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2 style="font-size:14px; margin:0;">📊 保存履歴</h2>
        <button id="btnDownloadAll" class="btn-blue" style="padding:5px 10px; font-size:12px;">📦 写真ごとDL</button>
      </div>
      <div class="table-container"><table><thead><tr><th>地点</th><th>写</th><th>G</th></tr></thead><tbody id="list"></tbody></table></div>
      <button id="btnDeleteAll" style="margin-top:10px; width:100%; background:#600; color:#fff; border:none; padding:5px; border-radius:4px;">全削除</button>
    </section>
  </main>

  <script src="../jszip.min.js"></script>
  <script src="./app.js?v=3.7"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('../sw.js', { scope: '../' }).then(() => console.log("SW OK"));
    }
  </script>
</body>
</html>
